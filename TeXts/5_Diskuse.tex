\chapter{Diskuse}

%
%Diskusi nepodceňujte. Je to nejdůležitější část a podle toho taky nejsložitější na napsání.
% Může se stát, že po napsání Diskuse budete muset přepsat třeba celý Úvod. Napsání kvalitní Diskuse vyžaduje
% spoustu času. Počítejte s tím. Za jeden večer to nenapíšete.
%
%Citát: \uv{Z krátké diskuse čiší stupidita autora, který vlastně neví co diskutovat.} Dr. B. Mandák, botanický ústav AVČR
%
%Bývá dobré začít shrnutím a interpretací vašich výsledků. Diskuse ale musí také ukázat jak výsledky zapadají do toho,
% co je o dané problematice známo. Musíte oddiskutovat jak soulad získaných výsledků s publikovanými tak i jejich nesoulad.
% Domníváte-li se, že jsou vaše výsledky zcela nové, pak vysvětlete v čem je jejich originalita.
% Pokud je nesoulad mezi výsledky vašimi a jiných badatelů, pak je nutné vysvětlit, čím k tomu mohlo dojít.
%
%Příklad: Sonntag (2001) sice uvádí, že by žížala mohla být i celkem krátká, neměl však k dispozici přesné měřítko, kterým žížalu měřím já.
%
%Nezapomeňte, že jste si v Úvodu vytyčili otázky a cíle. Na ně je třeba reagovat. Můžete i naznačit, jakým směrem by
% se teď po vašich zásadních objevech měl ubírat další výzkum. Můžete i formulovat nové hypotézy,
% které by měly být v budoucnu testovány. Pořadí diskutovaných okruhů by mělo být stejné jako bylo v Úvodu.
% Čtenář DP by měl být na Diskusi připraven Úvodem. Nemělo by se tedy stát, že se v Diskusi zjeví překvapivá
% fakta z prací jiných autorů, o nichž není v Úvodu ani zmínky.

\section{Shrnutí výsledků}

V konfirmační části práce jsme se pokusili formálně otestovat sedm hypotéz, které jsme na začátku formuluvali
na základě predikcí vyplývajících z teorie zamrzlé plasticity.
Hypotézy se týkaly vztahu množství pleiotropických alel a alel s opačným působením na fenotyp s dosaženou průměrnou
hodnotou fitness a jejím desetiprocentním percentilem, s rychlostí růstu fitness po změnách prostředí, s rychlostí
růstu fitness po dlouhém období stabilního prostředí a s četností vymírání populací.

Výsledky simulací ve zkoumané části prostoru možných parametrů simulace se v podstatě kvalitativně shodovaly s
našimi počátečními predikcemi, efekty však byly velmi malé a ani zdaleka nedosahovaly hranice statistické signifikance.
Formálně jsme tedy žádnou z našich hypotéz založených na teorii zamrzlé plasticity nepotvrdili.

Ukázala se pouze negativní závislost směrnice růstu fitness na počátku třetího období na podílu pleiotropních alel s
relativně malou silou efektu, která nepatřila k původně formulovaným hypotézám.

\section{Interpretace výsledků pro vymírání}

V datech je, zejména v druhém úseku, pozorovatelný trend očekávaným směrem, ale je slabý a není statisticky
signifikantní.

Možná vysvětlení se nacházejí v části Omezení.

\section{Interpretace výsledků pro dosažené fitness}

V datech je, zejména v druhém úseku, jak u průměrů, tak i u desetiprocentního percentilu fitness pozorovatelný trend
očekávaným směrem, ale je slabý a není statisticky signifikantní.

Možná vysvětlení se nacházejí v části Omezení.

\section{Interpretace výsledků pro růsty fitness po změnách optima}

Zde se ukázala pouze negativní závislost směrnice růstu fitness na počátku třetího období na podílu pleiotropních alel
s relativně malou silou efektu.

Přestože je výsledek signifikantní pro zvolenou hladinu $\alpha = 0.05$, tak je na místě
opatrnost, protože bylo testováno mnoho hypotéz a jejich částí a je proto možné, že jde o náhodnou chybu prvního
druhu -- artefakt vícečetých testů. \footnote{Povaha testů zde vylučuje užití běžných korekcí pro vícečetné
testy. XXX je to tak? XXX}
Tato závislost si ale jistě zaslouží být dále zkoumána a testována v navazujícím výzkumu.

\section{Interpretace výsledků pro růsty fitness na konci stabilních období}

Pro růsty fitness na koncích stabilních období nebyla nalezena závislost na parametrech.

Hlavním důvodem je nevhodně zvolená veličina. Na koncích období bývají již simulované populace vcelku stabilní a
změny fitness jsou obvykle jen drobným náhodným kolísáním. Pro budoucí měření je tedy nutné najít jinou veličinu,
která bude měřit, jak rychle se v populaci optimalizují fenotypy po počátečním rychlém růstu fitness. Vhodnou veličinou
by byl například čas nutný pro růst z fitnes 0.80 na fitness 0.95.

\section{Omezení}

Zvolená velikost rovnovážná velikost populace je pravděpodobně příliš malá. Šlo o důsledek technických, časových a
částečně finančních omezení, který by měl být v budoucí práci odstraněn, aby ve zkoumaných populacích hrála
větší roli selekce i pro alely s malými vlivy na fenotyp a aby se omezil vliv driftu.

Jako u každého, nejen počítačového, modelu se zde setkáme s nutností vyvážit jeho realističnost a jednoduchost. V
tomto případě bylo nutné omezit již zmíněnou velikost populací, dimenzionalitu prostoru fenotypů a počet lokusů.
To samozřejmě značně omezuje možnost zobecnit negativní výsledek na reálné situace. Je například možné, že očekávané
efekty by se projevily, pokud by se vztahy týkaly většího počtu alel -- pak by stačilo, aby některé z nich přispěly
velmi malým dílem k projevům elasticity, ale součet jejich vlivů už by byl měřitelný.

Pravděpodobně druhým nejdůležitějším omezením provedených simulací je to, že z časových a technických důvodů
pokryly pouze malou část prostoru možných parametrů -- čtyři hodnoty od 0.0 po 0.25 pro podíl negativně dominantních
alel a tři hodnoty od 0.0 do 0.5 pro podíl pleiotropních alel.

Podstatným omezením je také to, že byl simulován jen jeden způsob změn prostředí -- skoková změna optima a jeho
pozdější skokový návrat na původní hodnotu.

Dále není jisté, že podíl vznikajících alel s některou vlastností dále odpovídal jejich následnému zastoupení v
populaci. Je jasné, že některé druhy alel selekce udržovala v populaci více než jiné, a některé potenciálně užitečné
alely zase neměly šanci se rozšířit na významnější část populace (recesivní výhodné alely).

V dalších simulacích by mělo být sledováno chování jednotlivých typů alel a především je třeba sledovat zastoupení
negativně dominantních a pleiotropních alel v rovnovážné populaci.
Bude patrně třeba před vlastním zahájením simulačního pokusu (před první změnou  optima) nechat systém \uv{zahořet}
dlouhým stabilním obdobím, tj. nechat zde ustálit rovnovážné zastoupení jednotlivých typů alel,
a právě tyto rovnovážné podíly zanést do tabulek a použít v následných statistických testech jako nezávislé proměnné.

\section{Vhodnost zvolených nástrojů pro simulaci}

Vzhledem k jisté neobvyklosti zvolených nástrojů, které byly vybrány pro implementaci simulace, zejména jazyka Haskell,
je na místě stručně vyhodnotit jejich adekvátnost.

V literatuře uváděné výhody kombinace funkcionálního programování a silných statických typových systémů (např. \citet{meijer2004static} pro
statické typování, \citet{hughes1989functional} pro FP a \citet{Chiusano2016} a \citet{ray2014large} pro kombinaci)
potvrdila i zkušenost při vývoji
\textit{fbeagle}. Přísná disciplína statického jazyka pomáhala s návrhem i často zabránila tomu, aby byl chybný kód vůbec přeložen\footnote{
Aby byla přísná pravidla ještě přísnější, tak jsem pro překlad výpočetní části \textit{fbeagle} používal přepínač \texttt{-Wall}, který způsobí,
že všechna varování překladač považuje za chybu a nelze je tedy ignorovat.
}.

Rozpaky, obzvláště zpočátku, budila kvalita a dostupnost nástrojů. Ta se ale v průběhu implementace zlepšila, nahrazení \textit{cabaly} modernějším
\textit{stackem} bylo podstatnou úlevou a, obávám se, na některé \uv{neobvyklosti} jsem si zvykl.

\subsubsection{Kvalita kódu}

Velkou výhodou se stalo i \textit{property based testování}. Je poměrně obvyklé i doporučované \citep{williams2009effectiveness} psát ke kódu i kód, který jej
automaticky testuje. To, například podle \citet{beck2003test}, snižuje množství chyb i zlepšuje kvalitu návrhu\footnote{
Přesněji řečeno, Kent Beck to tvrdí o testech, které jsou psány dříve než testovaný kód na základě poměrně jednoduché,
ale striktní sady pravidel.}.
Co je podstatné, je i to, že kvalitní a dostatečně rozsáhlé automatické testování může podpořit i důvěru ve výsledky.

\textit{Property based testování} přináší tuto myšlenku ještě dále. Zatímco obvykle je otestováno, že kód pro pevně dané vstupy vrátí pevně
očekávané hodnoty, je možné i otestovat, že kód pro vstupy daných vlastností vrátí výsledky daných vlastností\footnote{
Například pokud mám dva fenotypy, první vzdálenější od aktuálního optima než druhý, tak první musí mít nižší fitness.
To platí pro všechny takové dvojice fenotypů.
}. Protože konkrétní vstupy nejsou součástí kódu testů, může jich testovací framework vygenerovat mnoho (ať už čistě náhodných nebo \uv{záludných})
a kód je tak otestován na mnoha různých vstupech.

Výhodou Haskellu a jeho knihovny QuickCheck \citep{Claessen:2000:QLT:351240.351266} je, že díky typovému systému velmi
často není třeba předepisovat, jak má generování vstupů vypadat, a tuto práci obstará počítač.
To hodnotím, ve srovnání s jinými obdobnými systémy, co jsem používal, jako značnou výhodu.

\subsubsection{Výkon}

Jako problematický se však ukázal výkon výsledného programu, zejména pak jeho značná paměťová náročnost.

Program je přeložen do nativního kódu, což odstraňuje část potenciálních výkonnostních problémů. Bohužel však jedna ze silných stránek
Haskellu, líné vyhodnocování, které m.j. umožňuje i snadnou tvorbu potenciálně nekonečných datových struktur, nese i negativum.
Tím je náročnost úvah o výkonu výsledného programu i tvorba nástrojů pro jeho zkoumání \citep{wadler1998no}.

To se projevilo i u \textit{fbeagle}. Ani základní analýza pomocí profileru nenašla hlavní příčinu množství alokované paměti.

Pokud se podaří tuto svízel odstranit nebo obejít, tak se tím otevře možnost spouštět větší množství simulací s větším množstvím kombinací
různých parametrů bez nutnosti spoléhat na cloud, a tedy i levněji. Dále to umožní prověřit současné výsledky spuštěním více simulací, což by
mohlo poskytnout výsledky signifikantní i pro nižší hladinu \textit{alfa.}

\subsubsection{Reprodukovatelnost}

Výsledný text práce je sázen prostřednictvím typografického systému \LaTeX. Můj původní plán spočíval v dotažení
automatizace a reprodukovatelnosti do extrému -- jedním příkazem by byl přeložen \textit{fbeagle}, následně
spuštěny simulace, výsledky statisticky zpracovány a vloženy do výsledného textu, z toho vygenerováno \textit{PDF}.

K tomu nedošlo, protože by kvůli nízkému výkonu \textit{fbeagle} bylo nepraktické čekat na simulace pro generování
\textit{PDF}.


\section{Další možnosti}

Program \textit{fbeagle} má poměrně široké možnosti, které dosud nebyly systematicky využity k
vygenerování dat vhodných pro statistickou analýzu.

Jistě má v budoucnu význam srovnat v této práci zkoumaný vliv pleiotropie a negativní dominance s případným vlivem
epistatických interakcí.

Další potenciálně zajímavá skupina parametrů pro navazující práci jsou plynulé periodické změny prostředí
a plynulý posun optimálního fenotypu jedním směrem, případně jejich kombinace.

Stranou zájmu by neměl zůstat ani možný vliv velikosti populace, tvrdé selekce a dimenzionality prostoru fenotypů.

Pro srovnání sexuálně se rozmnožujících a asexuálních druhů se nabízí možnost radikálnějších změn v \textit{fbeagle}
a přidání strategie\footnote{Ve smyslu návrhového vzoru strategie z \citet{GammaHelmEtAl95} upraveného pro potřeby
funkcionálního programování} pro rozmnožování asexuálních druhů.

Výpočetně náročnější, ale potenciálně zajímavé by byly simulace s podstatně vyším počtem kroků. Během nich by se, lze
předpokládat, samovolně hromadily frekvenčně závislé alely a tedy postupně stoupala elasticita.
Pomocí opakovaných změn prostředí bychom prověřili, zda na ně populace reaguje stále více elasticky.

\subsection{Měření evolvability}

Závažnější zásah do \textit{fbeagle}, na který bohužel nezbyl čas, je přidání měření toho, jak je populace
dále schopna vývoje. Jako vhodnější měřítko než použité směrnice aktuálního růstu na začátku zkoumaného období
se nabízí možnost simulovanou populaci nechat simulovaně (mimo hlavní simulaci, bez vlivu na její běh,
pouze jako měření vlastnosti této populace) adaptovat na několik různých optim a u toho změřit směrnici
růstu fitness.

Výhoda takovho přístupu je v tom, že neměří rychlost adaptace v jedné situaci, ale je možné změřit okamžitou schopnost
populace přizpůsobit se různým podmínkám.

Dalším argumentem pro takové měření je skutečnost, že nové optimální fenotypy mohou být umístěny ve zvolené vzdálenosti
od okamžitého průměrného fenotypu populace. To je pro měření schopnosti populace se vyvíjet výhodnější, než nový
optimální fenotyp umístit do zvolené vzdálenosti od předchozího optimálního fenotypu.
